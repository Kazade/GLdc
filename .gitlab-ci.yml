stages:
  - build
  - test

build:sh4-gcc:
  stage: build
  image: kazade/dreamcast-sdk
  script:
    - source /etc/bash.bashrc
    - make clean
    - make samples
    
test:sh4-gcc:
  stage: test
  image: kazade/dreamcast-sdk
  before_script:
    - dnf install -y wget findutils && dnf clean all
    - wget https://download1.rpmfusion.org/free/fedora/rpmfusion-free-release-$(rpm -E %fedora).noarch.rpm
    - rpm -i rpmfusion-free-release-$(rpm -E %fedora).noarch.rpm
    - dnf update -y
    - dnf install -y lxdream
  script:
    - source /etc/bash.bashrc
    - make test
    - lxdream --help
    - lxdream -H tests/tests.elf | python3 utils/test_parser.py
    
  
